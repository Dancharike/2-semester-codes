#include <iostream>
#include <fstream>
#include <cstdlib>
#include <ctime>

using namespace std;
struct line
{
    int number;
    int first_value;
    int second_value;
    string question;
    string answer;
};
void read(line* &list, int &n);
void write(line* list, int n);
void list_update(line* &list, int &n);
void game_play(line* list, int &n);
int main()
{
    int n;
    line* list = 0;
    read(list, n);
    game_play(list, n);
    //list_update(list, n);
    write(list, n);

    delete[] list;
}
//------------------------------------------------------
void read(line* &list, int &n)
{
    ifstream f1("data.txt");
    if (!f1.is_open())
    {
        cerr << "Error with opening file!" << endl;
        exit(1);
    }

    f1 >> n;
    f1.ignore();
    list = new line[n];
    for (int i = 0; i < n; ++i)
    {
        f1 >> list[i].number >> list[i].first_value >> list[i].second_value;
        f1.ignore();
        if (list[i].first_value != 0 || list[i].second_value != 0)
        {
            getline(f1 >> ws, list[i].question);
        }
        else
        {
            getline(f1 >> ws, list[i].answer);
        }
    }

    f1.close();
}
//------------------------------------------------------
void write(line* list, int n)
{
    ofstream f1("data_updated.txt");
    f1 << n << endl;
    for (int i = 0; i < n; ++i)
    {
        f1 << list[i].number << " " << list[i].first_value << " " << list[i].second_value << " ";
        if (list[i].first_value != 0 || list[i].second_value != 0)
        {
            f1 << list[i].question << endl;
        }
        else
        {
            f1 << list[i].answer << endl;
        }
    }

    f1.close();
}
//------------------------------------------------------
/*void list_update(line* &list, int &n)
{
    string question, correct_answer;
    cout << "What is the correct answer?: ";
    getline(cin, correct_answer);
    cout << "What is the question distinguishing it?: ";
    getline(cin, question);

    line* new_list = new line[n + 2];
    for (int i = 0; i < n; i++)
    {
        new_list[i] = list[i];
    }
    new_list[n].question = question;
    new_list[n].number = n;
    new_list[n].first_value = 0;
    new_list[n].second_value = 0;
    new_list[n + 1].answer = correct_answer;
    new_list[n + 1].number = n + 1;
    new_list[n + 1].first_value = 0;
    new_list[n + 1].second_value = 0;

    delete[] list;
    list = new_list;
    n += 2;
}*/
//------------------------------------------------------
void game_play(line* list, int &n)
{
    int ind=1, random_number, used_number;
    char input, menu_input;
    srand(static_cast<unsigned int>(time(0)));
    bool exit_game=false;

    while (!exit_game)
    {
        random_number=rand()%3+1; //random number that will be used in the future as a number of question
        used_number=random_number; //used number cannot be used twice by program 

        cout << "----------------------------------" << endl;
        cout << "This is decision tree game!" << endl;
        cout << "Please choose your option:" << endl;
        cout << "----------------------------------" << endl;
        cout << "1. Play the game" << endl;
        cout << "2. Add your questions" << endl;
        cout << "3. Close the game" << endl;
        cin >> menu_input;

        switch(menu_input)
        {
            case '1':
            {
                cout << "Hello world!" << endl;
                //There should be a one part of the code below!
                cout<<"Would you like to continue?"<<endl<<"Yes/No?"<<endl;
                cin>>input;
                if(toupper(input) == 'N')
                {
                    exit_game=true;
                }
                else
                {
                    bool valid_input = false;
                    while (!valid_input)
                    {
                        valid_input = true;
                    }
                }
                break;
            }
            case '2':
            {
                cout << "Enter your question:" << endl;
                cout<<"Would you like to continue?"<<endl<<"Yes/No?"<<endl;
                cin>>input;
                if(toupper(input) == 'N')
                {
                    exit_game=true;
                }
                else
                {
                    bool valid_input = false;
                    while (!valid_input)
                    {
                        valid_input = true;
                    }
                }
                break;
            }
            case '3':
            {
                cout<<"Do you want to close the game? (Yes/No)"<<endl;
                cin>>input;
                if(toupper(input) == 'Y')
                {
                    exit_game = true;
                }
                else
                {
                    bool valid_input = false;
                    while (!valid_input)
                    {
                        valid_input=true;
                    }
                }
                break;
            }
            default:
            {
                cout << "Invalid option, please make sure you are entering 1, 2, or 3!" << endl;
                break;
            }
        }
    }
    /*while(list[ind].first_value != 0 || list[ind].second_value != 0)
    {
        cout<<list[ind].question<<endl<<"Yes/No?"<<endl;
        cin>>input;
        cin.ignore();
        if(toupper(input) == 'Y')
            ind = list[ind].first_value;
        else
            ind = list[ind].second_value;
    }
    cout<<"Is it?: "<<list[ind].answer<<endl<<"Yes/No"<<endl;
    cin>>input;
    cin.ignore();
    if(toupper(input) == 'N')
    {
        list_update(list, n);
        ind = n;
    }*/
}
